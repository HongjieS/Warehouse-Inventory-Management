{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hongjie\\\\Desktop\\\\Warehouse Test\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\n// src/App.js\nimport React, { useState } from \"react\";\nimport * as XLSX from \"xlsx\";\nimport * as pdfjsLib from \"pdfjs-dist/build/pdf\";\nimport pdfWorker from \"pdfjs-dist/build/pdf.worker.entry\";\nimport { Container, Box, Typography, Button } from '@mui/material';\n\n// Initialize PDF.js worker\npdfjsLib.GlobalWorkerOptions.workerSrc = pdfWorker;\nimport { parsePDFEternal, parsePDFWorldFamous } from \"./parsers\";\nimport StockTable from \"./components/StockTable\";\nimport ImportPreview from \"./components/ImportPreview\";\nimport HistoryTable from \"./components/HistoryTable\";\nimport WorldFamousItems from './components/WorldFamousItems';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [currentBrand, setCurrentBrand] = useState(\"World Famous\");\n  const [worldFamousStock, setWorldFamousStock] = useState([]);\n  const [eternalStock, setEternalStock] = useState([]);\n  const [selectedFile, setSelectedFile] = useState(null);\n  const [importData, setImportData] = useState([]);\n  const [history, setHistory] = useState([]);\n  const [showHistory, setShowHistory] = useState(false);\n  const [showImportPreview, setShowImportPreview] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // For searching & filtering\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [selectedSize, setSelectedSize] = useState(\"\");\n  const [showInStockOnly, setShowInStockOnly] = useState(false);\n\n  // Edit mode\n  const [isEditMode, setIsEditMode] = useState(false);\n\n  // History\n  const [currentView, setCurrentView] = useState(\"Stock\");\n  const [items, setItems] = useState([]);\n\n  // 1. HISTORY HELPERS\n  const updateHistory = (actionType, details) => {\n    setHistory(prev => [...prev, {\n      date: new Date().toLocaleString(),\n      actionType,\n      brand: currentBrand,\n      details,\n      selected: false\n    }]);\n  };\n  const toggleHistorySelection = i => {\n    setHistory(prev => prev.map((entry, idx) => idx === i ? {\n      ...entry,\n      selected: !entry.selected\n    } : entry));\n  };\n  const exportSelectedHistoryToTextFile = () => {\n    const selected = history.filter(h => h.selected);\n    if (selected.length === 0) {\n      alert(\"No history selected.\");\n      return;\n    }\n    selected.forEach(entry => {\n      const text = `${entry.date} - ${entry.actionType}: ${JSON.stringify(entry.details)}`;\n      const blob = new Blob([text], {\n        type: \"text/plain\"\n      });\n      const url = URL.createObjectURL(blob);\n      const link = document.createElement(\"a\");\n      link.href = url;\n      link.download = `${entry.actionType}_history.txt`;\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n    });\n  };\n\n  // 2. FILE IMPORT\n  const handleFileChange = event => {\n    setSelectedFile(event.target.files[0]);\n    setImportData([]);\n    setShowImportPreview(false);\n    setError(null);\n  };\n  const handleImport = async () => {\n    if (!selectedFile) {\n      alert(\"Please select a file first\");\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    try {\n      const fileType = selectedFile.name.split(\".\").pop().toLowerCase();\n      let parsedData = [];\n      if (fileType === \"pdf\") {\n        const arrayBuffer = await selectedFile.arrayBuffer();\n\n        // First check if it's an Eternal invoice\n        try {\n          // Check for Eternal-specific content in the PDF\n          const pdf = await pdfjsLib.getDocument({\n            data: arrayBuffer\n          }).promise;\n          const firstPage = await pdf.getPage(1);\n          const content = await firstPage.getTextContent();\n          const text = content.items.map(item => item.str).join(\" \");\n\n          // Check for Eternal-specific markers\n          const isEternal = text.includes(\"Eternal Ink\") || text.includes(\"Eternal, LLC\") || text.includes(\"Eternal Ink, LLC\");\n          if (isEternal) {\n            parsedData = await parsePDFEternal(arrayBuffer);\n          } else {\n            // If not Eternal, try World Famous\n            parsedData = await parsePDFWorldFamous(arrayBuffer);\n          }\n        } catch (error) {\n          console.error(\"Error determining PDF type:\", error);\n          throw new Error(\"Could not determine the type of PDF invoice\");\n        }\n      } else if (fileType === \"xlsx\" || fileType === \"xls\") {\n        const data = await selectedFile.arrayBuffer();\n        const workbook = XLSX.read(data);\n        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];\n        const jsonData = XLSX.utils.sheet_to_json(firstSheet, {\n          header: 1\n        });\n        if (jsonData.length < 2) {\n          throw new Error(\"Excel file is empty or improperly formatted\");\n        }\n\n        // Find header row by looking for common column names\n        let headerRowIndex = 0;\n        for (let i = 0; i < jsonData.length; i++) {\n          const row = jsonData[i];\n          if (row.some(cell => cell && typeof cell === \"string\" && (cell.toLowerCase().includes(\"color\") || cell.toLowerCase().includes(\"quantity\") || cell.toLowerCase().includes(\"size\")))) {\n            headerRowIndex = i;\n            break;\n          }\n        }\n        const headers = jsonData[headerRowIndex];\n        const colorIndex = headers.findIndex(h => h && typeof h === \"string\" && h.toLowerCase().includes(\"color\"));\n        const quantityIndex = headers.findIndex(h => h && typeof h === \"string\" && h.toLowerCase().includes(\"quantity\"));\n        const sizeIndex = headers.findIndex(h => h && typeof h === \"string\" && h.toLowerCase().includes(\"size\"));\n        const itemCodeIndex = headers.findIndex(h => h && typeof h === \"string\" && h.toLowerCase().includes(\"item\"));\n        if (colorIndex === -1 || quantityIndex === -1) {\n          throw new Error(\"Excel file must contain at least 'Color' and 'Quantity' columns\");\n        }\n\n        // Process data starting from the row after headers\n        parsedData = jsonData.slice(headerRowIndex + 1).filter(row => row.some(cell => cell !== null && cell !== \"\")).map(row => {\n          const color = String(row[colorIndex] || \"\").trim();\n          const quantity = parseInt(row[quantityIndex]) || 0;\n          const size = sizeIndex !== -1 ? String(row[sizeIndex] || \"\").trim() : \"1oz\";\n          const itemCode = itemCodeIndex !== -1 ? String(row[itemCodeIndex] || \"\").trim() : \"\";\n          if (!color || isNaN(quantity)) {\n            return null;\n          }\n          return {\n            itemCode,\n            color,\n            quantity,\n            size: size || \"1oz\"\n          };\n        }).filter(Boolean);\n      } else {\n        throw new Error(\"Unsupported file type\");\n      }\n      if (parsedData.length === 0) {\n        throw new Error(\"No valid data found in the file\");\n      }\n      setImportData(parsedData);\n      setShowImportPreview(true);\n    } catch (error) {\n      console.error(\"Error processing file:\", error);\n      setError(error.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const confirmImport = () => {\n    if (importData.length === 0) return;\n    const updateStock = stock => {\n      const updated = [...stock];\n      importData.forEach(imp => {\n        const foundIdx = updated.findIndex(s => s.color === imp.color && s.size === imp.size);\n        if (foundIdx >= 0) {\n          updated[foundIdx].quantity += imp.quantity;\n        } else {\n          updated.push(imp);\n        }\n      });\n      return updated;\n    };\n    if (currentBrand === \"World Famous\") {\n      setWorldFamousStock(prev => updateStock(prev));\n    } else {\n      setEternalStock(prev => updateStock(prev));\n    }\n    setImportData([]);\n  };\n\n  // 3. EXPORT (OPTIONAL)\n  const handleExport = () => {\n    // Example: deduct from stock based on importData\n    if (importData.length === 0) {\n      alert(\"No items to export (importData is empty).\");\n      return;\n    }\n    let updated = currentBrand === \"World Famous\" ? [...worldFamousStock] : [...eternalStock];\n    let allGood = true;\n    importData.forEach(expItem => {\n      const idx = updated.findIndex(s => s.color === expItem.color && s.size === expItem.size);\n      if (idx >= 0) {\n        if (updated[idx].quantity >= expItem.quantity) {\n          updated[idx].quantity -= expItem.quantity;\n        } else {\n          allGood = false;\n          alert(`Not enough stock for ${expItem.color} (${expItem.size}). Need ${expItem.quantity}, have ${updated[idx].quantity}`);\n        }\n      } else {\n        allGood = false;\n        alert(`Cannot export unknown item: ${expItem.color} (${expItem.size})`);\n      }\n    });\n    if (allGood) {\n      if (currentBrand === \"World Famous\") {\n        setWorldFamousStock(updated);\n      } else {\n        setEternalStock(updated);\n      }\n      alert(\"Export complete!\");\n      updateHistory(\"Export\", importData);\n    }\n  };\n\n  // 4. STOCK FILTERS\n  const getCurrentStock = () => {\n    const stock = currentBrand === \"World Famous\" ? worldFamousStock : eternalStock;\n    return stock.filter(item => {\n      const colorMatch = item.color.toLowerCase().includes(searchQuery.toLowerCase());\n      const sizeMatch = selectedSize ? item.size === selectedSize : true;\n      const inStockMatch = !showInStockOnly || item.quantity > 0;\n      return colorMatch && sizeMatch && inStockMatch;\n    });\n  };\n  const totalBottles = getCurrentStock().reduce((acc, i) => acc + i.quantity, 0);\n\n  // 5. EDIT MODE\n  const enterEditMode = () => setIsEditMode(true);\n  const finalizeEditing = () => setIsEditMode(false);\n  const handleStockChange = (index, field, value) => {\n    const isWF = currentBrand === \"World Famous\";\n    const stock = isWF ? [...worldFamousStock] : [...eternalStock];\n    stock[index][field] = value;\n    if (isWF) {\n      setWorldFamousStock(stock);\n    } else {\n      setEternalStock(stock);\n    }\n  };\n  const addNewItem = () => {\n    const newItem = {\n      color: \"\",\n      quantity: 0,\n      size: \"\"\n    };\n    if (currentBrand === \"World Famous\") {\n      setWorldFamousStock(prev => [...prev, newItem]);\n    } else {\n      setEternalStock(prev => [...prev, newItem]);\n    }\n    updateHistory(\"Add New Item\", newItem);\n  };\n  const deleteItem = index => {\n    const confirmDelete = window.confirm(\"Delete this item?\");\n    if (!confirmDelete) return;\n    const isWF = currentBrand === \"World Famous\";\n    const stock = isWF ? [...worldFamousStock] : [...eternalStock];\n    const removed = stock[index];\n    stock.splice(index, 1);\n    if (isWF) setWorldFamousStock(stock);else setEternalStock(stock);\n    updateHistory(\"Delete Item\", removed);\n  };\n  const handleFileUpload = async event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    setIsLoading(true);\n    setError(null);\n    try {\n      const buffer = await file.arrayBuffer();\n      const parsedItems = await parsePDFWorldFamous(buffer);\n      setItems(parsedItems);\n    } catch (err) {\n      console.error('Error parsing PDF:', err);\n      setError('Failed to parse the invoice. Please make sure you uploaded a valid World Famous invoice PDF.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 6. RENDER\n  if (currentView === \"History\") {\n    // Show the History table\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"top-bar\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Warehouse Inventory\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setCurrentView(\"Stock\"),\n        children: \"Back to Stock\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(HistoryTable, {\n        history: history,\n        onToggleSelect: toggleHistorySelection\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 376,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: exportSelectedHistoryToTextFile,\n        children: \"Export Selected History\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 377,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Otherwise, show the main Stock view\n  const stockToDisplay = getCurrentStock();\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    children: /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        mt: 4,\n        mb: 4\n      },\n      children: [/*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h4\",\n        component: \"h1\",\n        gutterBottom: true,\n        children: \"World Famous Invoice Parser\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          mt: 2,\n          mb: 2\n        },\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          component: \"label\",\n          disabled: isLoading,\n          children: [\"Upload Invoice PDF\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            hidden: true,\n            accept: \".pdf\",\n            onChange: handleFileUpload\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 395,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 9\n      }, this), isLoading && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        sx: {\n          mt: 2\n        },\n        children: \"Processing invoice...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body1\",\n        color: \"error\",\n        sx: {\n          mt: 2\n        },\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 11\n      }, this), items.length > 0 && /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          mt: 3\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          gutterBottom: true,\n          children: [\"Parsed Items (\", items.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(WorldFamousItems, {\n          items: items\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 388,\n    columnNumber: 5\n  }, this);\n}\n_s(App, \"u5HqYR+TpwP1AprZG/9qYDqQO9s=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","XLSX","pdfjsLib","pdfWorker","Container","Box","Typography","Button","GlobalWorkerOptions","workerSrc","parsePDFEternal","parsePDFWorldFamous","StockTable","ImportPreview","HistoryTable","WorldFamousItems","jsxDEV","_jsxDEV","App","_s","currentBrand","setCurrentBrand","worldFamousStock","setWorldFamousStock","eternalStock","setEternalStock","selectedFile","setSelectedFile","importData","setImportData","history","setHistory","showHistory","setShowHistory","showImportPreview","setShowImportPreview","isLoading","setIsLoading","error","setError","searchQuery","setSearchQuery","selectedSize","setSelectedSize","showInStockOnly","setShowInStockOnly","isEditMode","setIsEditMode","currentView","setCurrentView","items","setItems","updateHistory","actionType","details","prev","date","Date","toLocaleString","brand","selected","toggleHistorySelection","i","map","entry","idx","exportSelectedHistoryToTextFile","filter","h","length","alert","forEach","text","JSON","stringify","blob","Blob","type","url","URL","createObjectURL","link","document","createElement","href","download","body","appendChild","click","removeChild","revokeObjectURL","handleFileChange","event","target","files","handleImport","fileType","name","split","pop","toLowerCase","parsedData","arrayBuffer","pdf","getDocument","data","promise","firstPage","getPage","content","getTextContent","item","str","join","isEternal","includes","console","Error","workbook","read","firstSheet","Sheets","SheetNames","jsonData","utils","sheet_to_json","header","headerRowIndex","row","some","cell","headers","colorIndex","findIndex","quantityIndex","sizeIndex","itemCodeIndex","slice","color","String","trim","quantity","parseInt","size","itemCode","isNaN","Boolean","message","confirmImport","updateStock","stock","updated","imp","foundIdx","s","push","handleExport","allGood","expItem","getCurrentStock","colorMatch","sizeMatch","inStockMatch","totalBottles","reduce","acc","enterEditMode","finalizeEditing","handleStockChange","index","field","value","isWF","addNewItem","newItem","deleteItem","confirmDelete","window","confirm","removed","splice","handleFileUpload","file","buffer","parsedItems","err","children","className","fileName","_jsxFileName","lineNumber","columnNumber","onClick","onToggleSelect","stockToDisplay","maxWidth","sx","mt","mb","variant","component","gutterBottom","disabled","hidden","accept","onChange","_c","$RefreshReg$"],"sources":["C:/Users/hongjie/Desktop/Warehouse Test/src/App.js"],"sourcesContent":["// src/App.js\r\nimport React, { useState } from \"react\";\r\nimport * as XLSX from \"xlsx\";\r\nimport * as pdfjsLib from \"pdfjs-dist/build/pdf\";\r\nimport pdfWorker from \"pdfjs-dist/build/pdf.worker.entry\";\r\nimport { Container, Box, Typography, Button } from '@mui/material';\r\n\r\n// Initialize PDF.js worker\r\npdfjsLib.GlobalWorkerOptions.workerSrc = pdfWorker;\r\n\r\nimport { parsePDFEternal, parsePDFWorldFamous } from \"./parsers\";\r\nimport StockTable from \"./components/StockTable\";\r\nimport ImportPreview from \"./components/ImportPreview\";\r\nimport HistoryTable from \"./components/HistoryTable\";\r\nimport WorldFamousItems from './components/WorldFamousItems';\r\n\r\nfunction App() {\r\n  const [currentBrand, setCurrentBrand] = useState(\"World Famous\");\r\n  const [worldFamousStock, setWorldFamousStock] = useState([]);\r\n  const [eternalStock, setEternalStock] = useState([]);\r\n\r\n  const [selectedFile, setSelectedFile] = useState(null);\r\n  const [importData, setImportData] = useState([]);\r\n  const [history, setHistory] = useState([]);\r\n  const [showHistory, setShowHistory] = useState(false);\r\n  const [showImportPreview, setShowImportPreview] = useState(false);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  // For searching & filtering\r\n  const [searchQuery, setSearchQuery] = useState(\"\");\r\n  const [selectedSize, setSelectedSize] = useState(\"\");\r\n  const [showInStockOnly, setShowInStockOnly] = useState(false);\r\n\r\n  // Edit mode\r\n  const [isEditMode, setIsEditMode] = useState(false);\r\n\r\n  // History\r\n  const [currentView, setCurrentView] = useState(\"Stock\");\r\n\r\n  const [items, setItems] = useState([]);\r\n\r\n  // 1. HISTORY HELPERS\r\n  const updateHistory = (actionType, details) => {\r\n    setHistory((prev) => [\r\n      ...prev,\r\n      {\r\n        date: new Date().toLocaleString(),\r\n        actionType,\r\n        brand: currentBrand,\r\n        details,\r\n        selected: false\r\n      }\r\n    ]);\r\n  };\r\n\r\n  const toggleHistorySelection = (i) => {\r\n    setHistory((prev) =>\r\n      prev.map((entry, idx) =>\r\n        idx === i ? { ...entry, selected: !entry.selected } : entry\r\n      )\r\n    );\r\n  };\r\n\r\n  const exportSelectedHistoryToTextFile = () => {\r\n    const selected = history.filter((h) => h.selected);\r\n    if (selected.length === 0) {\r\n      alert(\"No history selected.\");\r\n      return;\r\n    }\r\n    selected.forEach((entry) => {\r\n      const text = `${entry.date} - ${entry.actionType}: ${JSON.stringify(\r\n        entry.details\r\n      )}`;\r\n      const blob = new Blob([text], { type: \"text/plain\" });\r\n      const url = URL.createObjectURL(blob);\r\n      const link = document.createElement(\"a\");\r\n      link.href = url;\r\n      link.download = `${entry.actionType}_history.txt`;\r\n      document.body.appendChild(link);\r\n      link.click();\r\n      document.body.removeChild(link);\r\n      URL.revokeObjectURL(url);\r\n    });\r\n  };\r\n\r\n  // 2. FILE IMPORT\r\n  const handleFileChange = (event) => {\r\n    setSelectedFile(event.target.files[0]);\r\n    setImportData([]);\r\n    setShowImportPreview(false);\r\n    setError(null);\r\n  };\r\n\r\n  const handleImport = async () => {\r\n    if (!selectedFile) {\r\n      alert(\"Please select a file first\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const fileType = selectedFile.name.split(\".\").pop().toLowerCase();\r\n      let parsedData = [];\r\n\r\n      if (fileType === \"pdf\") {\r\n        const arrayBuffer = await selectedFile.arrayBuffer();\r\n        \r\n        // First check if it's an Eternal invoice\r\n        try {\r\n          // Check for Eternal-specific content in the PDF\r\n          const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;\r\n          const firstPage = await pdf.getPage(1);\r\n          const content = await firstPage.getTextContent();\r\n          const text = content.items.map((item) => item.str).join(\" \");\r\n          \r\n          // Check for Eternal-specific markers\r\n          const isEternal = text.includes(\"Eternal Ink\") || \r\n                          text.includes(\"Eternal, LLC\") || \r\n                          text.includes(\"Eternal Ink, LLC\");\r\n          \r\n          if (isEternal) {\r\n            parsedData = await parsePDFEternal(arrayBuffer);\r\n          } else {\r\n            // If not Eternal, try World Famous\r\n            parsedData = await parsePDFWorldFamous(arrayBuffer);\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error determining PDF type:\", error);\r\n          throw new Error(\"Could not determine the type of PDF invoice\");\r\n        }\r\n      } else if (fileType === \"xlsx\" || fileType === \"xls\") {\r\n        const data = await selectedFile.arrayBuffer();\r\n        const workbook = XLSX.read(data);\r\n        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];\r\n        const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });\r\n\r\n        if (jsonData.length < 2) {\r\n          throw new Error(\"Excel file is empty or improperly formatted\");\r\n        }\r\n\r\n        // Find header row by looking for common column names\r\n        let headerRowIndex = 0;\r\n        for (let i = 0; i < jsonData.length; i++) {\r\n          const row = jsonData[i];\r\n          if (\r\n            row.some(\r\n              (cell) =>\r\n                cell &&\r\n                typeof cell === \"string\" &&\r\n                (cell.toLowerCase().includes(\"color\") ||\r\n                  cell.toLowerCase().includes(\"quantity\") ||\r\n                  cell.toLowerCase().includes(\"size\"))\r\n            )\r\n          ) {\r\n            headerRowIndex = i;\r\n            break;\r\n          }\r\n        }\r\n\r\n        const headers = jsonData[headerRowIndex];\r\n        const colorIndex = headers.findIndex(\r\n          (h) => h && typeof h === \"string\" && h.toLowerCase().includes(\"color\")\r\n        );\r\n        const quantityIndex = headers.findIndex(\r\n          (h) => h && typeof h === \"string\" && h.toLowerCase().includes(\"quantity\")\r\n        );\r\n        const sizeIndex = headers.findIndex(\r\n          (h) => h && typeof h === \"string\" && h.toLowerCase().includes(\"size\")\r\n        );\r\n        const itemCodeIndex = headers.findIndex(\r\n          (h) => h && typeof h === \"string\" && h.toLowerCase().includes(\"item\")\r\n        );\r\n\r\n        if (colorIndex === -1 || quantityIndex === -1) {\r\n          throw new Error(\r\n            \"Excel file must contain at least 'Color' and 'Quantity' columns\"\r\n          );\r\n        }\r\n\r\n        // Process data starting from the row after headers\r\n        parsedData = jsonData\r\n          .slice(headerRowIndex + 1)\r\n          .filter((row) => row.some((cell) => cell !== null && cell !== \"\"))\r\n          .map((row) => {\r\n            const color = String(row[colorIndex] || \"\").trim();\r\n            const quantity = parseInt(row[quantityIndex]) || 0;\r\n            const size = sizeIndex !== -1 ? String(row[sizeIndex] || \"\").trim() : \"1oz\";\r\n            const itemCode =\r\n              itemCodeIndex !== -1 ? String(row[itemCodeIndex] || \"\").trim() : \"\";\r\n\r\n            if (!color || isNaN(quantity)) {\r\n              return null;\r\n            }\r\n\r\n            return {\r\n              itemCode,\r\n              color,\r\n              quantity,\r\n              size: size || \"1oz\",\r\n            };\r\n          })\r\n          .filter(Boolean);\r\n      } else {\r\n        throw new Error(\"Unsupported file type\");\r\n      }\r\n\r\n      if (parsedData.length === 0) {\r\n        throw new Error(\"No valid data found in the file\");\r\n      }\r\n\r\n      setImportData(parsedData);\r\n      setShowImportPreview(true);\r\n    } catch (error) {\r\n      console.error(\"Error processing file:\", error);\r\n      setError(error.message);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const confirmImport = () => {\r\n    if (importData.length === 0) return;\r\n\r\n    const updateStock = (stock) => {\r\n      const updated = [...stock];\r\n      importData.forEach((imp) => {\r\n        const foundIdx = updated.findIndex(\r\n          (s) => s.color === imp.color && s.size === imp.size\r\n        );\r\n        if (foundIdx >= 0) {\r\n          updated[foundIdx].quantity += imp.quantity;\r\n        } else {\r\n          updated.push(imp);\r\n        }\r\n      });\r\n      return updated;\r\n    };\r\n\r\n    if (currentBrand === \"World Famous\") {\r\n      setWorldFamousStock((prev) => updateStock(prev));\r\n    } else {\r\n      setEternalStock((prev) => updateStock(prev));\r\n    }\r\n    setImportData([]);\r\n  };\r\n\r\n  // 3. EXPORT (OPTIONAL)\r\n  const handleExport = () => {\r\n    // Example: deduct from stock based on importData\r\n    if (importData.length === 0) {\r\n      alert(\"No items to export (importData is empty).\");\r\n      return;\r\n    }\r\n    let updated =\r\n      currentBrand === \"World Famous\"\r\n        ? [...worldFamousStock]\r\n        : [...eternalStock];\r\n    let allGood = true;\r\n\r\n    importData.forEach((expItem) => {\r\n      const idx = updated.findIndex(\r\n        (s) => s.color === expItem.color && s.size === expItem.size\r\n      );\r\n      if (idx >= 0) {\r\n        if (updated[idx].quantity >= expItem.quantity) {\r\n          updated[idx].quantity -= expItem.quantity;\r\n        } else {\r\n          allGood = false;\r\n          alert(\r\n            `Not enough stock for ${expItem.color} (${expItem.size}). Need ${\r\n              expItem.quantity\r\n            }, have ${updated[idx].quantity}`\r\n          );\r\n        }\r\n      } else {\r\n        allGood = false;\r\n        alert(`Cannot export unknown item: ${expItem.color} (${expItem.size})`);\r\n      }\r\n    });\r\n\r\n    if (allGood) {\r\n      if (currentBrand === \"World Famous\") {\r\n        setWorldFamousStock(updated);\r\n      } else {\r\n        setEternalStock(updated);\r\n      }\r\n      alert(\"Export complete!\");\r\n      updateHistory(\"Export\", importData);\r\n    }\r\n  };\r\n\r\n  // 4. STOCK FILTERS\r\n  const getCurrentStock = () => {\r\n    const stock =\r\n      currentBrand === \"World Famous\" ? worldFamousStock : eternalStock;\r\n    return stock.filter((item) => {\r\n      const colorMatch = item.color\r\n        .toLowerCase()\r\n        .includes(searchQuery.toLowerCase());\r\n      const sizeMatch = selectedSize ? item.size === selectedSize : true;\r\n      const inStockMatch = !showInStockOnly || item.quantity > 0;\r\n      return colorMatch && sizeMatch && inStockMatch;\r\n    });\r\n  };\r\n\r\n  const totalBottles = getCurrentStock().reduce((acc, i) => acc + i.quantity, 0);\r\n\r\n  // 5. EDIT MODE\r\n  const enterEditMode = () => setIsEditMode(true);\r\n  const finalizeEditing = () => setIsEditMode(false);\r\n\r\n  const handleStockChange = (index, field, value) => {\r\n    const isWF = currentBrand === \"World Famous\";\r\n    const stock = isWF ? [...worldFamousStock] : [...eternalStock];\r\n    stock[index][field] = value;\r\n    if (isWF) {\r\n      setWorldFamousStock(stock);\r\n    } else {\r\n      setEternalStock(stock);\r\n    }\r\n  };\r\n\r\n  const addNewItem = () => {\r\n    const newItem = { color: \"\", quantity: 0, size: \"\" };\r\n    if (currentBrand === \"World Famous\") {\r\n      setWorldFamousStock((prev) => [...prev, newItem]);\r\n    } else {\r\n      setEternalStock((prev) => [...prev, newItem]);\r\n    }\r\n    updateHistory(\"Add New Item\", newItem);\r\n  };\r\n\r\n  const deleteItem = (index) => {\r\n    const confirmDelete = window.confirm(\"Delete this item?\");\r\n    if (!confirmDelete) return;\r\n    const isWF = currentBrand === \"World Famous\";\r\n    const stock = isWF ? [...worldFamousStock] : [...eternalStock];\r\n    const removed = stock[index];\r\n    stock.splice(index, 1);\r\n    if (isWF) setWorldFamousStock(stock);\r\n    else setEternalStock(stock);\r\n    updateHistory(\"Delete Item\", removed);\r\n  };\r\n\r\n  const handleFileUpload = async (event) => {\r\n    const file = event.target.files[0];\r\n    if (!file) return;\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n    \r\n    try {\r\n      const buffer = await file.arrayBuffer();\r\n      const parsedItems = await parsePDFWorldFamous(buffer);\r\n      setItems(parsedItems);\r\n    } catch (err) {\r\n      console.error('Error parsing PDF:', err);\r\n      setError('Failed to parse the invoice. Please make sure you uploaded a valid World Famous invoice PDF.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  // 6. RENDER\r\n  if (currentView === \"History\") {\r\n    // Show the History table\r\n    return (\r\n      <div>\r\n        <div className=\"top-bar\">\r\n          <h1>Warehouse Inventory</h1>\r\n        </div>\r\n        <button onClick={() => setCurrentView(\"Stock\")}>Back to Stock</button>\r\n        <HistoryTable history={history} onToggleSelect={toggleHistorySelection} />\r\n        <button onClick={exportSelectedHistoryToTextFile}>\r\n          Export Selected History\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Otherwise, show the main Stock view\r\n  const stockToDisplay = getCurrentStock();\r\n\r\n  return (\r\n    <Container maxWidth=\"lg\">\r\n      <Box sx={{ mt: 4, mb: 4 }}>\r\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n          World Famous Invoice Parser\r\n        </Typography>\r\n        \r\n        <Box sx={{ mt: 2, mb: 2 }}>\r\n          <Button\r\n            variant=\"contained\"\r\n            component=\"label\"\r\n            disabled={isLoading}\r\n          >\r\n            Upload Invoice PDF\r\n            <input\r\n              type=\"file\"\r\n              hidden\r\n              accept=\".pdf\"\r\n              onChange={handleFileUpload}\r\n            />\r\n          </Button>\r\n        </Box>\r\n\r\n        {isLoading && (\r\n          <Typography variant=\"body1\" sx={{ mt: 2 }}>\r\n            Processing invoice...\r\n          </Typography>\r\n        )}\r\n\r\n        {error && (\r\n          <Typography variant=\"body1\" color=\"error\" sx={{ mt: 2 }}>\r\n            {error}\r\n          </Typography>\r\n        )}\r\n\r\n        {items.length > 0 && (\r\n          <Box sx={{ mt: 3 }}>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              Parsed Items ({items.length})\r\n            </Typography>\r\n            <WorldFamousItems items={items} />\r\n          </Box>\r\n        )}\r\n      </Box>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}